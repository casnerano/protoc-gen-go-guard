// Code generated by protoc-gen-go-guard. DO NOT EDIT.
// versions:
// - protoc-gen-go-grpc {{ .Meta.ModuleVersion }}
// - protoc             {{ .Meta.ProtocVersion }}
// source: {{ .File.Source }}

package {{ .File.Package }}

import (
    "github.com/casnerano/protoc-gen-go-guard/pkg/guard"
)

{{- range .Services }}
    var guardService_{{ .Name }} = guard.Service{
        Name: "{{ .Name }}",
        {{- if .Rules }}
            Rules: &guard.Rules{
                {{- if .Rules.AllowPublic }}
                    AllowPublic: guard.Ptr({{ .Rules.AllowPublic }}),
                {{- end }}
                {{- if .Rules.RequireAuthn }}
                    RequireAuthn: guard.Ptr({{ .Rules.RequireAuthn }}),
                {{- end }}
                {{- if .Rules.RoleBased }}
                    RoleBased: &guard.RoleBased{
                        {{- if .Rules.RoleBased.AllowedRoles }}
                            AllowedRoles: []string{
                                {{- range $i, $role := .Rules.RoleBased.AllowedRoles }}
                                    "{{ $role | toLower }}",
                                {{- end }}
                            },
                            {{- if .Rules.RoleBased.Requirement }}
                                Requirement: guard.Requirement({{ .Rules.RoleBased.Requirement }}),
                            {{- end }}
                        {{- end }}
                    },
                {{- end }}
                {{- if .Rules.PolicyBased }}
                    PolicyBased: &guard.PolicyBased{
                        {{- if .Rules.PolicyBased.PolicyNames }}
                            PolicyNames: []string{
                                {{- range $i, $policy := .Rules.PolicyBased.PolicyNames }}
                                    "{{ $policy }}",
                                {{- end }}
                            },
                            {{- if .Rules.PolicyBased.Requirement }}
                                Requirement: guard.Requirement({{ .Rules.PolicyBased.Requirement }}),
                            {{- end }}
                        {{- end }}
                    },
                {{- end }}
            },
        {{- end }}
        Methods: map[string]*guard.Method{
            {{- range $name, $method := .Methods }}
            "{{ $name }}": {
                Rules: &guard.Rules{
                    {{- if $method.Rules.AllowPublic }}
                        AllowPublic: guard.Ptr({{ $method.Rules.AllowPublic }}),
                    {{- end }}
                    {{- if $method.Rules.RequireAuthn }}
                        RequireAuthn: guard.Ptr({{ $method.Rules.RequireAuthn }}),
                    {{- end }}
                    {{- if $method.Rules.RoleBased }}
                        RoleBased: &guard.RoleBased{
                            {{- if $method.Rules.RoleBased.AllowedRoles }}
                                AllowedRoles: []string{
                                    {{- range $j, $role := $method.Rules.RoleBased.AllowedRoles }}
                                        "{{ $role | toLower }}",
                                    {{- end }}
                                },
                                {{- if $method.Rules.RoleBased.Requirement }}
                                    Requirement: guard.Requirement({{ $method.Rules.RoleBased.Requirement }}),
                                {{- end }}
                            {{- end }}
                        },
                    {{- end }}
                    {{- if $method.Rules.PolicyBased }}
                        PolicyBased: &guard.PolicyBased{
                            {{- if $method.Rules.PolicyBased.PolicyNames }}
                                PolicyNames: []string{
                                    {{- range $k, $policy := $method.Rules.PolicyBased.PolicyNames }}
                                        "{{ $policy }}",
                                    {{- end }}
                                },
                                {{- if $method.Rules.PolicyBased.Requirement }}
                                    Requirement: guard.Requirement({{ $method.Rules.PolicyBased.Requirement }}),
                                {{- end }}
                            {{- end }}
                        },
                    {{- end }}
                },
            },
            {{- end }}
        },
    }

    func (Unimplemented{{ .Name }}Server) GetGuardService() *guard.Service {
        return &guardService_{{ .Name }}
    }
{{- end }}

